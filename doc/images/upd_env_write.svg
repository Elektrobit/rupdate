<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1113px" preserveAspectRatio="none" style="width:779px;height:1113px;" version="1.1" viewBox="0 0 779 1113" width="779px" zoomAndPan="magnify"><defs><filter height="300%" id="ffd3bzolpz2t8" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#ffd3bzolpz2t8)" height="1099.5028" style="stroke: #000000; stroke-width: 1.0;" width="765.5" x="3" y="3"/><path d="M127,4 L127,15.0679 L117,25.0679 L3,25.0679 " fill="none" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="6" y="18.9659">update env write</text><rect fill="#DDDDDD" height="1052.1258" style="stroke: #A80036; stroke-width: 1.0;" width="711.5" x="24" y="33.0679"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="47" x="356.25" y="46.9649">System</text><rect fill="#FFFFFF" filter="url(#ffd3bzolpz2t8)" height="688.0479" style="stroke: #000000; stroke-width: 2.0;" width="733.5" x="18" y="386.1459"/><rect fill="#FFFFFF" height="142.806" style="stroke: none; stroke-width: 1.0;" width="733.5" x="18" y="531.6759"/><rect fill="#FFFFFF" height="351.0239" style="stroke: none; stroke-width: 1.0;" width="733.5" x="18" y="674.4819"/><rect fill="#FFFFFF" filter="url(#ffd3bzolpz2t8)" height="288.336" style="stroke: #000000; stroke-width: 2.0;" width="565" x="176.5" y="698.4638"/><rect fill="#FFFFFF" height="142.806" style="stroke: none; stroke-width: 1.0;" width="565" x="176.5" y="843.9939"/><rect fill="#FFFFFF" height="48.6879" style="stroke: none; stroke-width: 1.0;" width="733.5" x="18" y="1025.5058"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="55" x2="55" y1="138.9098" y2="1091.1937"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="215.5" x2="215.5" y1="138.9098" y2="1091.1937"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="499.5" x2="499.5" y1="138.9098" y2="1091.1937"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="657.5" x2="657.5" y1="138.9098" y2="1091.1937"/><rect fill="#FEFECE" filter="url(#ffd3bzolpz2t8)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="28" y="100.8419"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="35" y="122.8078">caller</text><rect fill="#FEFECE" filter="url(#ffd3bzolpz2t8)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="54" x="186.5" y="100.8419"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="193.5" y="122.8078">writer</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="425.5" y="115.7399">update environment</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="466" y="134.8078">location 1</text><path d="M481.5,64.7739 C481.5,54.7739 499.5,54.7739 499.5,54.7739 C499.5,54.7739 517.5,54.7739 517.5,64.7739 L517.5,90.7739 C517.5,100.7739 499.5,100.7739 499.5,100.7739 C499.5,100.7739 481.5,100.7739 481.5,90.7739 L481.5,64.7739 " fill="#FEFECE" filter="url(#ffd3bzolpz2t8)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M481.5,64.7739 C481.5,74.7739 499.5,74.7739 499.5,74.7739 C499.5,74.7739 517.5,74.7739 517.5,64.7739 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="583.5" y="115.7399">update environment</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="624" y="134.8078">location 2</text><path d="M639.5,64.7739 C639.5,54.7739 657.5,54.7739 657.5,54.7739 C657.5,54.7739 675.5,54.7739 675.5,64.7739 L675.5,90.7739 C675.5,100.7739 657.5,100.7739 657.5,100.7739 C657.5,100.7739 639.5,100.7739 639.5,90.7739 L639.5,64.7739 " fill="#FEFECE" filter="url(#ffd3bzolpz2t8)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M639.5,64.7739 C639.5,74.7739 657.5,74.7739 657.5,74.7739 C657.5,74.7739 675.5,74.7739 675.5,64.7739 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#EEEEEE" filter="url(#ffd3bzolpz2t8)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="753.5" x="8" y="170.7628"/><line style="stroke: #000000; stroke-width: 1.0;" x1="8" x2="761.5" y1="170.7628" y2="170.7628"/><line style="stroke: #000000; stroke-width: 1.0;" x1="8" x2="761.5" y1="173.7628" y2="173.7628"/><rect fill="#EEEEEE" filter="url(#ffd3bzolpz2t8)" height="25.706" style="stroke: #000000; stroke-width: 2.0;" width="54" x="357.75" y="158.9098"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="363.75" y="176.8068">Write</text><polygon fill="#A80036" points="203.5,214.3218,213.5,218.3218,203.5,222.3218,207.5,218.3218" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="55.5" x2="209.5" y1="218.3218" y2="218.3218"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="62.5" y="212.5128">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="73.5" y="212.5128">request to write data</text><polygon fill="#A80036" points="487.5,246.0278,497.5,250.0278,487.5,254.0278,491.5,250.0278" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="215.5" x2="493.5" y1="250.0278" y2="250.0278"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="222.5" y="244.2188">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="233.5" y="244.2188">read raw data</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="215.5" x2="257.5" y1="281.7338" y2="281.7338"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="257.5" x2="257.5" y1="281.7338" y2="294.7338"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="216.5" x2="257.5" y1="294.7338" y2="294.7338"/><polygon fill="#A80036" points="226.5,290.7338,216.5,294.7338,226.5,298.7338,222.5,294.7338" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="222.5" y="275.9248">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="233.5" y="275.9248">verify ID, version and checksum</text><polygon fill="#A80036" points="645.5,322.4398,655.5,326.4398,645.5,330.4398,649.5,326.4398" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="215.5" x2="651.5" y1="326.4398" y2="326.4398"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="222.5" y="320.6308">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="233.5" y="320.6308">read raw data</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="215.5" x2="257.5" y1="358.1459" y2="358.1459"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="257.5" x2="257.5" y1="358.1459" y2="371.1459"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="216.5" x2="257.5" y1="371.1459" y2="371.1459"/><polygon fill="#A80036" points="226.5,367.1459,216.5,371.1459,226.5,375.1459,222.5,371.1459" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="222.5" y="352.3369">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="233.5" y="352.3369">verify ID, version and checksum</text><path d="M18,386.1459 L81,386.1459 L81,395.1459 L71,405.1459 L18,405.1459 L18,386.1459 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="688.0479" style="stroke: #000000; stroke-width: 2.0;" width="733.5" x="18" y="386.1459"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="33" y="401.0429">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="96" y="399.9048">[only location 1 valid]</text><polygon fill="#A80036" points="226.5,425.5579,216.5,429.5579,226.5,433.5579,222.5,429.5579" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="220.5" x2="498.5" y1="429.5579" y2="429.5579"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="232.5" y="423.7489">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="243.5" y="423.7489">copy env_revision</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="215.5" x2="257.5" y1="478.9699" y2="478.9699"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="257.5" x2="257.5" y1="478.9699" y2="491.9699"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="216.5" x2="257.5" y1="491.9699" y2="491.9699"/><polygon fill="#A80036" points="226.5,487.9699,216.5,491.9699,226.5,495.9699,222.5,491.9699" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="222.5" y="464.3079">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="233.5" y="455.4549">increment env_revision,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="249" x="236.5" y="473.1609">set data as requested, calculate checksum</text><polygon fill="#A80036" points="645.5,519.6759,655.5,523.6759,645.5,527.6759,649.5,523.6759" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="215.5" x2="651.5" y1="523.6759" y2="523.6759"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="222.5" y="517.8669">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="30" x="233.5" y="517.8669">write</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="18" x2="751.5" y1="532.6759" y2="532.6759"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="23" y="544.4349">[only location 2 valid]</text><polygon fill="#A80036" points="226.5,568.3639,216.5,572.3639,226.5,576.3639,222.5,572.3639" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="220.5" x2="656.5" y1="572.3639" y2="572.3639"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="232.5" y="566.5549">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="243.5" y="566.5549">copy env_revision</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="215.5" x2="257.5" y1="621.7759" y2="621.7759"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="257.5" x2="257.5" y1="621.7759" y2="634.7759"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="216.5" x2="257.5" y1="634.7759" y2="634.7759"/><polygon fill="#A80036" points="226.5,630.7759,216.5,634.7759,226.5,638.7759,222.5,634.7759" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="222.5" y="607.1139">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="240.5" y="598.2609">increment env_revision,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="249" x="243.5" y="615.9669">set data as requested, calculate checksum</text><polygon fill="#A80036" points="487.5,662.4819,497.5,666.4819,487.5,670.4819,491.5,666.4819" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="215.5" x2="493.5" y1="666.4819" y2="666.4819"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="222.5" y="660.6729">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="30" x="240.5" y="660.6729">write</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="18" x2="751.5" y1="675.4819" y2="675.4819"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="23" y="687.2408">[both valid]</text><path d="M176.5,698.4638 L239.5,698.4638 L239.5,707.4638 L229.5,717.4638 L176.5,717.4638 L176.5,698.4638 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="288.336" style="stroke: #000000; stroke-width: 2.0;" width="565" x="176.5" y="698.4638"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="191.5" y="713.3608">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="348" x="254.5" y="712.2227">[env_revision from location 1 is higher or equal than location 2]</text><polygon fill="#A80036" points="226.5,737.8758,216.5,741.8758,226.5,745.8758,222.5,741.8758" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="220.5" x2="498.5" y1="741.8758" y2="741.8758"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="232.5" y="736.0668">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="250.5" y="736.0668">copy env_revision</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="215.5" x2="257.5" y1="791.2879" y2="791.2879"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="257.5" x2="257.5" y1="791.2879" y2="804.2879"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="216.5" x2="257.5" y1="804.2879" y2="804.2879"/><polygon fill="#A80036" points="226.5,800.2879,216.5,804.2879,226.5,808.2879,222.5,804.2879" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="222.5" y="776.6258">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="240.5" y="767.7728">increment env_revision,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="249" x="243.5" y="785.4789">set data as requested, calculate checksum</text><polygon fill="#A80036" points="645.5,831.9939,655.5,835.9939,645.5,839.9939,649.5,835.9939" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="215.5" x2="651.5" y1="835.9939" y2="835.9939"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="222.5" y="830.1849">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="30" x="240.5" y="830.1849">write</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="176.5" x2="741.5" y1="844.9939" y2="844.9939"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="299" x="181.5" y="856.7528">[env_revision from location 2 is higher than location 1]</text><polygon fill="#A80036" points="226.5,880.6818,216.5,884.6818,226.5,888.6818,222.5,884.6818" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="220.5" x2="656.5" y1="884.6818" y2="884.6818"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="232.5" y="878.8728">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="250.5" y="878.8728">copy env_revision</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="215.5" x2="257.5" y1="934.0938" y2="934.0938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="257.5" x2="257.5" y1="934.0938" y2="947.0938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="216.5" x2="257.5" y1="947.0938" y2="947.0938"/><polygon fill="#A80036" points="226.5,943.0938,216.5,947.0938,226.5,951.0938,222.5,947.0938" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="222.5" y="919.4318">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="240.5" y="910.5788">increment env_revision,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="249" x="243.5" y="928.2848">set data as requested, calculate checksum</text><polygon fill="#A80036" points="487.5,974.7998,497.5,978.7998,487.5,982.7998,491.5,978.7998" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="215.5" x2="493.5" y1="978.7998" y2="978.7998"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="222.5" y="972.9908">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="30" x="240.5" y="972.9908">write</text><polygon fill="#A80036" points="66.5,1013.5058,56.5,1017.5058,66.5,1021.5058,62.5,1017.5058" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="60.5" x2="214.5" y1="1017.5058" y2="1017.5058"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="72.5" y="1011.6968">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="90.5" y="1011.6968">report success</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="18" x2="751.5" y1="1026.5058" y2="1026.5058"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="23" y="1038.2648">[both invalid]</text><polygon fill="#A80036" points="66.5,1062.1937,56.5,1066.1937,66.5,1070.1937,62.5,1066.1937" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="60.5" x2="214.5" y1="1066.1937" y2="1066.1937"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="72.5" y="1060.3847">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="90.5" y="1060.3847">report error</text><!--MD5=[753d4b53a3fb0c80ff8df663416ffb5d]
@startuml upd_env_write

hide footbox
autonumber

box "System"
        participant "caller" as caller

        participant "writer" as writer

        database "update environment \n location 1" as updenv1
        database "update environment \n location 2" as updenv2
end box


mainframe update env write


== Write ==

caller -> writer :  request to write data

writer -> updenv1 : read raw data
writer -> writer : verify ID, version and checksum

writer -> updenv2 : read raw data
writer -> writer : verify ID, version and checksum

alt only location 1 valid

 writer <- updenv1 : copy env_revision
 writer -> writer: increment env_revision, \n set data as requested, calculate checksum
 writer -> updenv2 : write

else only location 2 valid

 writer <- updenv2 : copy env_revision
 writer -> writer : increment env_revision, \n set data as requested, calculate checksum
 writer -> updenv1 : write

else both valid

alt env_revision from location 1 is higher or equal than location 2

 writer <- updenv1 : copy env_revision
 writer -> writer: increment env_revision, \n set data as requested, calculate checksum
 writer -> updenv2 : write

else env_revision from location 2 is higher than location 1

 writer <- updenv2 : copy env_revision
 writer -> writer: increment env_revision, \n set data as requested, calculate checksum
 writer -> updenv1 : write

end

writer -> caller : report success

else both invalid

writer -> caller : report error



end

@enduml

PlantUML version 1.2020.02(Sun Mar 01 11:22:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.22+7-post-Ubuntu-0ubuntu222.04.1
Operating System: Linux
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>